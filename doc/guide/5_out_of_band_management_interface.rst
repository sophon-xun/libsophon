带外管理接口说明
-------------------

SMBUS 协议接口定义
~~~~~~~~~~~~~~~~~~~~~

命令组成
^^^^^^^^^^^

先写 1 byte 的 CMD 到 i2c slave, 再读取 n byte 数据。以下为读取 CHIP0 芯片温度的例子:

.. code-block:: shell

    #先往 slave 地址为 0x60 的设备写数据 0x0
    i2c write 0x60 (slave addr) 0x0 (cmd)
    #再从 slave 地址为 0x60 的设备读取 1 byte 数据
    i2c read 0x60 (slave addr) 0x1 (n byte)


SC5 系列板卡带外管理接口
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

说明
^^^^^^
:服务器厂商 BMC 控制:

- SC5 系列多芯卡 Slave 地址 CHIP0 为 0x60, CHIP1 为 0x61, CHIP2 为 0x62。

- 返回int类型数据时候按照高字节在前顺序发送(例如int类型数为 0x16841e30,返回顺序为 0x16, 0x84, 0x1e, 0x30)。

SC5+ MCU 接口命令
^^^^^^^^^^^^^^^^^^^^^^

.. table::
   :widths: 25 15 10 100

   ============== ========== ======== =============================================
      含义         地址        属性        说明
   -------------- ---------- -------- ---------------------------------------------
   芯片温度         0x00       RO          unsigned byte, 单位:摄氏度
   -------------- ---------- -------- ---------------------------------------------
   单板温度         0x01       RO          unsigned byte, 单位:摄氏度
   -------------- ---------- -------- ---------------------------------------------
   单板功耗         0x02       RO          unsigned byte, 单位:瓦
   -------------- ---------- -------- ---------------------------------------------
   风扇速度占比     0x03       RO          unsigned byte, 0xff表示无风扇
   -------------- ---------- -------- ---------------------------------------------
   Vendor ID       0x10       RO            unsigned int;[31:16]:Device ID 0x1684;[15:0]:Vendor ID 0x1e30;
   -------------- ---------- -------- ---------------------------------------------
   硬件版本         0x14       RO          unsigned byte
   -------------- ---------- -------- ---------------------------------------------
   固件版本         0x18       RO          unsigned int;[7:0]小版本号;[15:8]主版本号;[31:16]chip版本号
   -------------- ---------- -------- ---------------------------------------------
   板卡种类         0x1c       RO          unsigned byte(代表板卡种类,sc5+是7)
   -------------- ---------- -------- ---------------------------------------------
   Sub Vendor ID   0x20       RO          unsigned int;[15:0]:sub Vendor ID 0x0;[31:16]:sub system ID 0x0
   ============== ========== ======== =============================================

备注：

- 单板功耗只能从 0x60 的 0x02 地址读取
- unsigned int  表示该地址有效数据4个字节大小
- unsigned byte 表示该地址有效数据1个字节大小


SC7 系列板卡带外管理接口
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

说明
^^^^^^
:服务器厂商 BMC 控制:

- SC7 系列多芯卡 Slave 地址为 0x60, CHIP1 为 0x61, CHIP2 为 0x62, 依此类推, CHIP7 为 0x67。

- 返回int类型数据时候按照高字节在前顺序发送(例如int类型数为 0x16861f1c,返回顺序为 0x16, 0x86, 0x1f, 0x1c)。

SC7PRO MCU 接口命令
^^^^^^^^^^^^^^^^^^^^^^

.. table::
   :widths: 25 15 10 100

   ============== ========== ======== =============================================
      含义         地址        属性        说明
   -------------- ---------- -------- ---------------------------------------------
   芯片温度         0x00       RO          unsigned byte, 单位:摄氏度
   -------------- ---------- -------- ---------------------------------------------
   单板温度         0x01       RO          unsigned byte, 单位:摄氏度
   -------------- ---------- -------- ---------------------------------------------
   单板功耗         0x02       RO          unsigned byte, 单位:瓦
   -------------- ---------- -------- ---------------------------------------------
   风扇速度占比     0x03       RO          unsigned byte, 0xff表示无风扇
   -------------- ---------- -------- ---------------------------------------------
   Vendor ID       0x10       RO            unsigned int;[31:16]:Device ID 0x1686;[15:0]:Vendor ID 0x1f1c;
   -------------- ---------- -------- ---------------------------------------------
   硬件版本         0x14       RO          unsigned byte
   -------------- ---------- -------- ---------------------------------------------
   固件版本         0x18       RO          unsigned int;[7:0]小版本号;[15:8]主版本号;[31:16]chip版本号
   -------------- ---------- -------- ---------------------------------------------
   板卡种类         0x1c       RO          unsigned byte(代表板卡种类,sc7pro是0x21)
   -------------- ---------- -------- ---------------------------------------------
   Sub Vendor ID   0x20       RO          unsigned int;[15:0]:sub Vendor ID 0x0;[31:16]:sub system ID 0x0
   -------------- ---------- -------- ---------------------------------------------
   SN ID           0x24        RO         产品序列号
   -------------- ---------- -------- ---------------------------------------------
   MCU Version     0x36        RO         unsigned byte; MCU版本号:0
   ============== ========== ======== =============================================

备注：

- 单板功耗只能从 0x60 的 0x02 地址读取
- unsigned int  表示该地址有效数据4个字节大小
- unsigned byte 表示该地址有效数据1个字节大小